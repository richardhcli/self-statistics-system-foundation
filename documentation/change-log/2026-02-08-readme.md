# Change Log â€” 2026-02-08

## Datastores Debug View & Persistence Synchronization

### New Features
- **Datastores Debug View**: Added ability to inspect Local vs. Backend state in a split panel.
- **Force Sync Panel**: Implemented "Fetch from Backend" and "Apply to Stores" manual synchronization tools.
- **Data Inspection**: Added `json-container-renderer` for recursive JSON data visualization with delete actions.
- **Backend Visibility**: Added `DatabaseView` to list and manage Firestore collections/documents directly from the debug interface.

### Bug Fixes
- **AI Config Persistence**: Fixed `actions` being lost during hydration by adding `partialize` and `merge` to `useAiConfigStore`. This resolved the `actions.setConfig is not a function` crash during Force Sync.

### Documentation
- Detailed feature spec and implementation details: [2026-02-08-DATASTORES_DEBUG_VIEW.md](./2026-02-08-DATASTORES_DEBUG_VIEW.md)

Journal read-aside migration cleanup removed the legacy journal migration helper and clarified that IndexedDB is a persistent cache, not the source of truth, aligning the persistence layer with the storage blueprint.

## graph storage in database first

CDAG topology now follows the read-aside architecture with Firebase-backed services, structure-first caching, and legacy sync removal. The store persists only data (nodes, edges, structure, metadata) and integrates a structure subscription hook for graph views.

Graph storage paths were standardized to `users/{uid}/graphs/cdag_topology` with nodes/edges in subcollections, eliminating invalid document references in the visual graph.

## Firestore schema naming cleanup

Firestore user profile and settings paths now use snake_case collection and document IDs (`account_config`, `ai_settings`, `user_information`, `profile_display`). Debug datastore fetch/force sync utilities were updated to match, aligning runtime access with the naming rules.

## Firebase backend documentation split

Completed the migration plan Phase 3 updates to reflect the current schema, and split the architecture Firebase backend doc into index + schema/auth/feature references for easier navigation.

## Storage architecture audit

Reviewed the 2026-02-07 storage blueprint against the current codebase. Journal and CDAG stores use the read-aside model with Firebase-backed fetches, cache metadata, and IndexedDB persistence. User info, AI config, player statistics, and integrations stores remain local-only (persisted to IndexedDB without read-aside fetches). Updated architecture docs to remove local-first language and clarify the hybrid read-aside model and current migration status.
